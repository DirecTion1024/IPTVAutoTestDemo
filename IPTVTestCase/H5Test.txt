*** Settings ***
Resource          ../Resources/Environment.txt
Library           NewLibrary

*** Test Cases ***
IPTVLiveH5Test
    ${Process}    Set Variable    com.fiberhome.iptv
    ${androidProcess}=    Create Dictionary    androidProcess=${Process}
    ${UNICODEKEYBOARD}    Set Variable    True
    ${RESETKEYBOARD}    Set Variable    True
    rc_right
    Open Application    ${SERVERURL}    platformName=${PLATFORMNAME}    platformVersion=${PLATFORMVERSION}    deviceName=${DEVICENAME}    automationName=${AUTOMATIONNAME}    appPackage=${APPPACKAGE}
    ...    appActivity=${APPACTIVITY}    noSign=${NOSIGN}    udid=${UDID}    unicodeKeyboard=True    resetKeyboard=True    chromeOptions=${androidProcess}
    sleep    5
    open_live
    sleep    5
    Capture Page Screenshot
    ${contexts}    get_contexts
    ${current_context}    get_current_context
    Switch To Context    WEBVIEW_com.fiberhome.iptv
    Log Source
    ${current_context}    get_current_context
    rc_left
    : FOR    ${i}    IN RANGE    1    7
    \    rc_down
    Log Source
    特殊频道
    Switch To Context    NATIVE_APP
    ${current_context}    get_current_context
    频道列表截图
    send_email    xiangfang@iflytek.com    liveshot

fiberhome
    ${Process}    Set Variable    com.fiberhome.iptv
    ${androidProcess}=    Create Dictionary    androidProcess=${Process}
    ${UNICODEKEYBOARD}    Set Variable    True
    ${RESETKEYBOARD}    Set Variable    True
    rc_right
    open_youku
    sleep    3
    rc_backkey
    Open Application    ${SERVERURL}    platformName=${PLATFORMNAME}    platformVersion=${PLATFORMVERSION}    deviceName=${DEVICENAME}    automationName=${AUTOMATIONNAME}    appPackage=${APPPACKAGE}
    ...    appActivity=${APPACTIVITY}    noSign=${NOSIGN}    udid=${UDID}    unicodeKeyboard=True    resetKeyboard=True    chromeOptions=${androidProcess}
    sleep    2
    rc_ok
    sleep    2
    ${contexts}    get_contexts
    ${current_context}    get_current_context
    Switch To Context    WEBVIEW_com.fiberhome.iptv
    Log Source
    ${log}    Set Variable    Log Source

youkutest
    ${Process}    Set Variable    com.fiberhome.iptv
    ${androidProcess}=    Create Dictionary    androidProcess=${Process}
    ${UNICODEKEYBOARD}    Set Variable    True
    ${RESETKEYBOARD}    Set Variable    True
    Open Application    ${SERVERURL}    platformName=${PLATFORMNAME}    platformVersion=${PLATFORMVERSION}    deviceName=${DEVICENAME}    automationName=${AUTOMATIONNAME}    appPackage=${APPPACKAGE}
    ...    appActivity=${APPACTIVITY}    noSign=${NOSIGN}    udid=${UDID}    unicodeKeyboard=True    resetKeyboard=True    chromeOptions=${androidProcess}
    sleep    10
    open_youku
    sleep    3
    rc_ok
    sleep    2
    ${linenumber}    Line Number    f:\youku.txt
    log    ${linenumber}
    ${looptimes}    Evaluate    int(${linenumber})+1
    : FOR    ${i}    IN RANGE    1    ${looptimes}
    \    ${url}    youku_search    F:\youku.txt    ${i}
    \    open_url    ${url}
    \    sleep    3
    \    ${contexts}    get_contexts
    \    ${current_context}    get_current_context
    \    Switch To Context    WEBVIEW_com.fiberhome.iptv
    \    sleep    2
    \    Run Keyword If    "${i}"=="1"    switch_to_frame
    \    ${content}    log_source
    \    log    ${content}
    \    ${id}    read_id    ${url}
    \    log    ${id}
    \    wirte_youku_file    ${id}    ${content}

test
    ${linenumber}    Line Number    f:\youku.txt
    log    ${linenumber}
    ${looptimes}    Evaluate    int(${linenumber})+1
    : FOR    ${i}    IN RANGE    1    ${looptimes}
    \    ${Process}    Set Variable    com.fiberhome.iptv
    \    ${androidProcess}=    Create Dictionary    androidProcess=${Process}
    \    ${UNICODEKEYBOARD}    Set Variable    True
    \    ${RESETKEYBOARD}    Set Variable    True
    \    Open Application    ${SERVERURL}    platformName=${PLATFORMNAME}    platformVersion=${PLATFORMVERSION}    deviceName=${DEVICENAME}    automationName=${AUTOMATIONNAME}
    \    ...    appPackage=${APPPACKAGE}    appActivity=${APPACTIVITY}    noSign=${NOSIGN}    udid=${UDID}    unicodeKeyboard=True
    \    ...    resetKeyboard=True    chromeOptions=${androidProcess}
    \    sleep    10
    \    open_youku
    \    sleep    3
    \    rc_ok
    \    sleep    2
    \    ${url}    youku_search    F:\youku.txt    ${i}
    \    open_url    ${url}
    \    sleep    3
    \    ${contexts}    get_contexts
    \    ${current_context}    get_current_context
    \    Switch To Context    WEBVIEW_com.fiberhome.iptv
    \    sleep    2
    \    switch_to_frame
    \    ${content}    Log Source
    \    log    ${content}
    \    ${id}    read_id    ${url}
    \    log    ${id}
    \    wirte_youku_file    ${id}    ${content}

*** Keywords ***
特殊频道
    Page Should Contain Text    CCTV-3
    Page Should Contain Text    CCTV-5
    Page Should Contain Text    CCTV-6
    Page Should Contain Text    CCTV-8

频道列表截图
    sx_screen_shot    liveshot
